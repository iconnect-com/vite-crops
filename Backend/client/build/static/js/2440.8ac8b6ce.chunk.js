"use strict";(self.webpackChunkcommodityvirtualdashboard=self.webpackChunkcommodityvirtualdashboard||[]).push([[2440],{82440:(e,i,l)=>{l.r(i),l.d(i,{default:()=>R});var t=l(65043),s=l(91490),n=l(45050),a=l(44326),d=l(59748),o=l(47419),r=l(11645),c=l(35483),m=l(29157),x=l(89029),u=l(1210),v=l(25589),h=l(87021),g=l(33563),p=l(59781),f=l(7205),y=l(19590),j=l(50867),b=l(81210),w=l(90914),A=l(79698),S=l(88764),N=l(37762),C=l(65239),k=l.n(C),P=l(17586),E=l(70579);var D,I=l(57528),_=l(66423);function z(e){let{icon:i,size:l="1em",className:t="",...s}=e;return(0,E.jsx)(F,{className:"anticon",children:(0,E.jsx)(_.In,{icon:i,width:l,height:l,className:"m-auto ".concat(t),...s})})}const F=l(87871).Ay.div(D||(D=(0,I.A)(["\n  display: inline-flex;\n  vertical-align: middle;\n  svg {\n    display: inline-block;\n  }\n"])));const R=()=>{var e;const i=(0,p.jE)(),{data:l}=(0,j.kI)(),{publicCommodities:C}=(0,t.useContext)(g.y),{user:D}=(0,t.useContext)(w.c),I=(0,j.KQ)(),_=null===l||void 0===l?void 0:l.map(((e,i)=>({...e,index:i}))),F=[{id:0,name:"Select Currency",code:"",symbol:""},{id:1,name:"Dollar (US)",code:"USD",symbol:"$"},{id:2,name:"Euro (EU)",code:"EUR",symbol:"\u20ac"},{id:3,name:"Pound (UK)",code:"GBP",symbol:"\xa3"},{id:4,name:"Swiss Franc (SUI)",code:"CHF",symbol:"CHF"},{id:6,name:"Yen (JPN)",code:"JPY",symbol:"\xa5"},{id:7,name:"Rand (SA)",code:"ZAR",symbol:"R"},{id:8,name:"Rupee (IND)",code:"INR",symbol:"\u20b9"},{id:9,name:"Peso (MEX)",code:"MXN",symbol:"$"},{id:10,name:"Canadian Dollar (CAD)",code:"CAD",symbol:"C$"}],[R,U]=(0,t.useState)({alert:""}),[L,B]=t.useState(!1),[M,H]=(0,t.useState)(!1),[W,O]=(0,t.useState)(0),[T,G]=(0,t.useState)(void 0),$=null===C||void 0===C?void 0:C[W],[q,J]=t.useState(F[0].code),K=F.find((e=>e.code===q)),[Q,V]=(0,t.useState)({}),[X,Y]=(0,t.useState)({}),[Z,ee]=(0,t.useState)({}),ie=(0,S.zU)("USD"),[le,te]=(0,t.useState)(void 0);(0,t.useEffect)((()=>{W&&te((()=>{const e=null===C||void 0===C?void 0:C.find((e=>e._id===T));return null===e||void 0===e?void 0:e.name})())}),[W]);const se=null!==ie&&void 0!==ie&&ie.conversion_rates?ie.conversion_rates[q]:void 0,ne=(null===(e=ie.conversion_rates)||void 0===e?void 0:e.NGN)||0,ae=null===$||void 0===$?void 0:$.current_price,de=null===$||void 0===$?void 0:$.previous_price,oe=(e=>{if(Q){if("USD"===q)return de/ne;return de/ne*se}return null})(),re=(e=>{if(Q){if("USD"===q)return ae/ne;return ae/ne*se}return null})();(0,t.useEffect)((()=>{V(se||{}),Y(oe||de),ee(re||ae)}),[se,oe,re,de,ae]);const{mutate:ce}=(0,j.s1)(null===D||void 0===D?void 0:D._id),me=(0,f.l)(),[xe]=d.A.useForm(),[ue,ve]=(0,t.useState)(!1),he=(0,t.useMemo)((()=>{if(!le)return[];const e=Array(12).fill(0),i=null===_||void 0===_?void 0:_.filter((e=>e.commodity._id===T));if(!i)return[];i.forEach((i=>{const l=new Date(i.effective_date).getMonth();e[l]++}));return[{name:le,data:e}]}),[T,le,_]);return(0,E.jsxs)(s.A,{Heading:"Dashboard",Background:n,children:[(0,E.jsxs)("div",{className:"flex flex-col sm:flex-row",children:[(0,E.jsx)(a.ht,{data:I}),(0,E.jsx)(a.VF,{forecasts:[]})]}),(0,E.jsx)("div",{className:"mt-9 w-full sm:w-full",children:(0,E.jsxs)(o.A,{gutter:12,className:"gap-4 sm:gap-0",children:[(0,E.jsxs)(r.A,{xs:24,sm:24,md:4,lg:4,children:[(0,E.jsxs)("div",{style:{fontSize:"12px",fontWeight:"bold",letterSpacing:".8px",color:"white",marginBottom:"1rem",paddingLeft:"2rem",background:"#658127",width:"100%",height:"40px",display:"flex",alignItems:"center"},children:["Available Crops"," "]}),null===C||void 0===C?void 0:C.map(((e,i)=>(0,E.jsx)("div",{onClick:()=>{G(e._id),O(i)},style:{cursor:"pointer",padding:"10px",fontSize:"12px",background:W===i?"#d0d0d0":"#f0f0f0"},children:e.name},e._id)))]}),(0,E.jsxs)(r.A,{xs:24,sm:24,md:4,lg:4,children:[(0,E.jsxs)("div",{className:"flex flex-row mb-7",children:[(0,E.jsx)("div",{className:"font-bold text-sm",children:"Price History "})," ",(0,E.jsxs)("span",{style:{borderRadius:"20px",padding:"5px",fontSize:".6rem",fontWeight:"bold",letterSpacing:".8px",color:"#39462D",marginLeft:"1rem",background:"#65812729"},children:["Today"," "]}),(0,E.jsx)("div",{className:"ml-5",onClick:()=>H(!M),children:(0,E.jsx)(b.A,{})}),M&&(0,E.jsx)(E.Fragment,{children:(0,E.jsx)(c.A,{open:M,onChange:(e,i)=>{H(!1)},onOpenChange:ve,style:{width:0,visibility:"hidden"},popupStyle:{visibility:"visible"},variant:"borderless"})})]}),(0,E.jsx)(m.A,{style:{borderRadius:"5px",height:"50%",width:"100%",objectFit:"cover"},src:Array.isArray(null===$||void 0===$?void 0:$.image)?null===$||void 0===$?void 0:$.image[0]:(null===$||void 0===$?void 0:$.image)||"",fallback:"https://via.placeholder.com/150",placeholder:(0,E.jsx)("div",{style:{height:"50%",width:"100%",display:"flex",justifyContent:"center",alignItems:"center"},children:(0,E.jsx)(x.A,{size:"large"})})})]}),(0,E.jsxs)(r.A,{xs:24,sm:24,md:12,lg:12,children:[(0,E.jsxs)("div",{className:"lg:ml-8",children:[(0,E.jsxs)("div",{className:"flex flex-row mb-7 lg:mt-12",children:[(0,E.jsx)("div",{className:"font-bold text:2xl lg:text-3xl ",children:null===$||void 0===$?void 0:$.name}),(0,E.jsxs)("span",{onClick:()=>{B(!0)},style:{outline:".5px solid #000",borderRadius:"40px",padding:"9px",fontSize:".7rem",fontWeight:"bold",letterSpacing:".8px",justifyContent:"center",alignItems:"center",display:"flex",marginLeft:"1rem",cursor:"pointer"},children:["Price Alert"," "]})]}),(0,E.jsx)("div",{children:(0,E.jsx)(u.A,{title:"Set Price Alert",open:L,onOk:()=>{},onCancel:()=>{xe.resetFields(),B(!1)},width:400,footer:null,centered:!0,children:(0,E.jsxs)(d.A,{name:"Price Alert",onFinish:ce,className:"flex flex-col  mb-4 mt-12 justify-center bg-white w-full",form:xe,requiredMark:!1,layout:"vertical",children:[(0,E.jsx)(d.A.Item,{label:"Select Crop",name:"commodity",rules:[{required:!0,message:"Please select a Commodity"}],children:(0,E.jsx)(v.A,{options:null===C||void 0===C?void 0:C.map((e=>({label:e.name,value:e._id}))),allowClear:!0,filterOption:(e,i)=>null===i||void 0===i?void 0:i.label.toLowerCase().includes(e.toLowerCase()),showSearch:!0,className:" w-full",value:(null===R||void 0===R?void 0:R.alert)||"",onChange:e=>{return i="alert",l=e,void U((e=>({...e,[i]:l})));var i,l},style:{backgroundColor:"#EBE9E9",marginTop:"-2rem",marginBottom:"1rem"}})}),(0,E.jsx)("div",{className:"flex justify-end",children:(0,E.jsx)(d.A.Item,{children:(0,E.jsxs)(h.Ay,{onClick:e=>{e.preventDefault();const l=new FormData;l.append("alert",(null===R||void 0===R?void 0:R.alert)||""),ce(l,{onSuccess:()=>{xe.resetFields(),i.invalidateQueries([A.l.notification]),B(!1)}})},name:"email",type:"primary",htmlType:"submit",className:"w-30 rounded bg-blue-500 hover:text-black hover:bg-white text-sm",style:{background:"linear-gradient(89.46deg, #39462D 13.05%, #658127 107.23%)",color:"white"},loading:Boolean(me),children:["Submit"," "]})})})]})})}),(0,E.jsxs)("div",{className:"flex flex-row mb-4",children:[(0,E.jsx)("div",{className:" text-sm mr-4",children:"Previous Price"}),(0,E.jsxs)("div",{className:" text-sm text-bold",children:[" ",(null===K||void 0===K?void 0:K.symbol)||"\u20a6"," ",(X||"").toLocaleString()]})]}),(0,E.jsxs)("div",{className:"flex flex-row mb-7",children:[(0,E.jsx)("div",{className:" text-sm mr-4",children:"Current Price"}),(0,E.jsxs)("div",{className:" text-sm text-bold",children:[" ",(null===K||void 0===K?void 0:K.symbol)||"\u20a6"," ",(Z||"").toLocaleString()]})]})]}),(0,E.jsx)("div",{id:"line-chart",children:(0,E.jsx)(y.A,{data:he})})]}),(0,E.jsx)(r.A,{xs:24,sm:24,md:4,lg:4,className:"lg:mt-12",children:(0,E.jsx)(v.A,{defaultValue:F[0].name,style:{width:"100%"},onChange:e=>{J(e)},children:F.map((e=>(0,E.jsx)(v.A.Option,{value:e.code,children:e.name},e.id)))})})]})}),(0,E.jsx)("div",{className:"mt-1 w-[350px] sm:w-full",children:(0,E.jsxs)(o.A,{gutter:12,className:"gap-1 sm:gap-0",children:[(0,E.jsx)(r.A,{xs:24,sm:24,md:4,lg:4}),(0,E.jsx)(r.A,{xs:24,sm:24,md:4,lg:4}),(0,E.jsx)(r.A,{xs:24,sm:24,md:12,lg:12,children:(0,E.jsxs)("div",{className:"lg:ml-10 flex flex-col mb-5 gap-2",children:[(0,E.jsxs)("div",{className:"flex flex-row",children:[(0,E.jsx)("div",{style:{borderRadius:"20px",padding:"5px",fontSize:".8rem",fontWeight:"bold",color:"white",background:"#658127",textAlign:"center",alignItems:"center",justifyContent:"center"},className:"ml-3 flex w-[200px] mt-4 sm:mt-8",children:"Expert Analysis"}),(0,E.jsx)("div",{className:"ml-3 mr-8 flex w-[600px] mt-4 sm:mt-8",children:(0,E.jsxs)(h.Ay,{type:"default",onClick:async()=>{if(W&&$){const i=new N.uE("p","mm","a4"),l=i.internal.pageSize.getWidth(),t=i.internal.pageSize.getHeight(),s=async(e,s,n)=>{const a=document.getElementById(e);if(a){const e=await k()(a),d=e.toDataURL("image/png"),o=l/e.width,r=t/e.height,c=Math.min(o,r),m=e.width*c-20,x=e.height*c-20;i.setFontSize(16),i.text("Commodity Report",l/2,20,{align:"center"}),i.setFontSize(12),i.text("Commodity Name: ".concat(null===$||void 0===$?void 0:$.name),10,30,{align:"left"}),i.text("Commodity Previous Price: ".concat(null===$||void 0===$?void 0:$.previous_price),10,35,{align:"left"}),i.text("Commodity New Price: ".concat(null===$||void 0===$?void 0:$.current_price),10,40,{align:"left"}),i.text("Expert Analysis: ".concat(null===$||void 0===$?void 0:$.analysis),10,50,{align:"left"});const u=n+40;return i.addImage(d,"PNG",s,u,m,x),x}};try{await new Promise((e=>setTimeout(e,1e3)));await s("line-chart",7,30);i.save("download.pdf")}catch(e){(0,P.n7)("Error while exporting")}}},style:{display:"flex",alignItems:"center",justifyContent:"center"},children:[(0,E.jsx)(z,{size:18,icon:"line-md:download-loop"}),"Export"]})})]}),(0,E.jsx)("div",{id:"analysis",className:"ml-2 text-sm mt-5",children:null===$||void 0===$?void 0:$.analysis})]})}),(0,E.jsx)(r.A,{xs:24,sm:24,md:4,lg:4})]})})]})}},45050:(e,i,l)=>{e.exports=l.p+"static/media/medium-shot-woman-ii.532c5632e37e442fe297.jpg"}}]);
//# sourceMappingURL=2440.8ac8b6ce.chunk.js.map